<!DOCTYPE html>
<html>
<head>
    <title>Min portfolio</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Gjør designet responsivt etter størrelsen-->
<!-- width=device-width - gjør at designet tilpasses skjermbredden -->
 <!-- initial-scale=1.0 - setter utgangspunkt for zooming når siden først lastes i nettleseren -->
 <link rel="stylesheet" href="Tabs.css">
</head>
<body>


<ul class="topnav">
    <li><a href="index.html">Hjem</a></li>
    <li><a href="Del1.html">Del 1</a></li>
    <li><a href="Del2.html">Del 2</a></li>
    <li><a href="#about">Del 3</a></li>
    <li><a href="#about">Del 4</a></li>
</ul>


<main>
<h1>Del 2</h1>
<p>Her tester jeg ut <a href="https://www.w3schools.com/howto/howto_js_tabs.asp">tabs</a> og <a href="https://www.w3schools.com/howto/howto_css_modal_images.asp">modal image.</a></p>

<!-- Tab links -->
<div class="tab">
  <button class="tablinks" onclick="openCity(event, 'Command')">Command</button>
  <button class="tablinks" onclick="openCity(event, 'SQL')">SQL</button>
  <button class="tablinks" onclick="openCity(event, 'XPath')">XPath</button>
  <button class="tablinks" onclick="openCity(event, 'XSS')">XSS</button>
</div>

<!-- Tab content -->
<div id="Command" class="tabcontent">
        <h2>Command Injections</h2>
        <p><a href="https://cwe.mitre.org/data/definitions/74.html">CWE-74</a>: En bred kategori av sårbarheter der angriperen kan injisere og utføre skadelig kode.</p>
    </header>
  <h2>Command injections</h2>
  <p>Data blir lagt inn i en applikasjon, som tolker dette som en kommando og kjører kode.</p>
  <p>For eksempel hvis applikasjonen jobber opp mot SQL, shell (cmd.exe, bash), LDAP, XPath og andre.</p>
  <h3>Løsning på disse problemene</h3>
    <ul>
      <li>Validering av input med å "whiteliste" gyldige tegn og verdier</li>
      <li>Koding av output, slik at spesialtegn ikke tolkes som kode</li>
      <li>Eliminere farlige innsettingspunkter, for eksempel ved å bruke textContent i stedet for innerHTML i JavaScript</li>     
    </ul>
  <h3>CWE</h3>
  <p>CWE har kategorisert injections med nummer 74. </p>
  <a href="https://cwe.mitre.org/data/definitions/74.html">CWE-74</a>
  <p>På nettsiden til cwe kan du lengst nede se kodeeksempler og hva som er feil med koden. </p>
  <div class="image-container">
            <img id="myImg" src="Images/CWE74.png" alt="Illustrasjon av command angrep" style="width:100%; max-width:400px; border-radius: 8px; cursor: pointer;">
            <!-- The Modal -->
              <div id="myModal" class="modal">
              <span class="close">&times;</span>
              <img class="modal-content" id="img01">
               <div id="caption"></div>
              </div> 
          </div>
   <h4>Teori</h4>
   <ul>
    <li>Book: D. Stuttard and M. Pinto The Web Application Hacker’s Handbook, 2nd Edition, Chapters 9, 10, 12</li>
    <li><a href="https://portswigger.net/web-security/sql-injection">SQL Injection Labs</a> from PortSwigger</li>
    <li><a href="https://www.youtube.com/playlist?list=PLuyTk2_mYISLaZC4fVqDuW_hOk0dd5rlf">YouTube playlist om SQL-injeksjoner</a></li>
    <li><a href="https://www.youtube.com/playlist?list=PLuyTk2_mYISK9ywsFZZOT1LuO3Eb7Wq5q">YouTube playlist om Command-injeksjoner</a></li>
    <li><a href="https://www.youtube.com/playlist?list=PLuyTk2_mYISL2DdD_m1ELEjpiPKxV98MO">YouTube playlist om Directory Traversal</a></li>
    <li><a href="https://www.invicti.com/blog/web-security/sql-injection-cheat-sheet/">Invicti SQL Injection Cheat Sheet</a></li>
    <li><a href="Xpath-WP.pdf">Xpath injection tutorial</a></p>
    <li><a href="https://web.dev/articles/csp">Content Security Policy (CSP)</a></p>
    </ul>      
  </div>

<div id="SQL" class="tabcontent">
  <h3>SQL injections</h3>
  <p>Et angrep hvor en angriper injiserer skadelig SQL-kode i et spørringsspråk som brukes av applikasjonen.</p>
  <p>Dette er en underkategori til Command injections, der SQL-injeksjoner har ID 89, og er "child" til 74.</p>
  <p>Du kan lære mer om <a href="https://www.youtube.com/watch?v=1nJgupaUPEQ&list=PLuyTk2_mYISLaZC4fVqDuW_hOk0dd5rlf&index=1">SQL-injeksjoner.</a></p>
  
  <section class="variants">
    <h2>Varianter av SQL-injeksjoner</h2>
      <div class="card-grid">
        <div class="card">
          <h3>1. In-band (Classic)</h3>
            <p>Dette er den vanligste og mest direkte formen for angrep, der angriperen bruker <strong>samme kommunikasjonskanal/applikasjon til både å utføre angrepet og hente ut resultatene</strong> </p>
            <p><strong>UNION-basert:</strong> Bruker <code>UNION</code>-operatøren for å kombinere resultater fra den originale spørringen med data fra andre tabeller. Dette er ofte den raskeste metoden for datatrekking</p>
            <p><strong>For eksempel</strong> be om brukernavn og passord til brukeren av applikasjonen. </p>
            <p><strong>Feilbasert (Error-based):</strong> Utnytter detaljerte feilmeldinger fra databasen (f.eks. ODBC-feil) for å hente ut informasjon om databasens struktur og innhold </p>  
            <p><strong>For eksempel:</strong> Du legger inn " i koden, og får en feilmelding, der feilemeldingen forteller deg databaseversjon, type database, og noen ganger hvilken sql-spørring som bir brukt i backend. </p>
        </div>
        <div class="card">
          <h3>Inferential (Blind)</h3>
          <p>Her henter man ikke ut noe fra databasen, men bruker <strong>Boolean</strong> og <strong>Time</strong></p>
          <p><strong>Betingede responser (Boolean-based):</strong> Angriperen sender logiske spørsmål (sant/usant) og ser om innholdet på siden endres eller om det oppstår en feil </p>
          <p><strong>Tidsforsinkelser (Time-delay):</strong> Angriperen tvinger databasen til å vente et bestemt antall sekunder før den svarer dersom en betingelse er sann. Dette bekrefter sårbarheten selv uten synlige endringer i innholdet.</p>
        </div>
        <div class="card">
          <h3>Out-of-band</h3>
            <p>Den som utfører angrepet er ute av stand til å bruke samme kanal som angrepet utføres i. </p>
            <p>Bruker for eksempel dns eller http requesgt for å gi data til en angriper. </p>
        </div>
      </div>
  </section>

  <p></p>

   <section class="variants">
    <h2>Eksempler på SQL-injeksjoner</h2>
      <div class="card-grid">
        <div class="card">
          <h3>Omgåelse av innlogging (Bypass)</h3>
          <p>Ved å bruke kommentartegn eller logiske sannheter kan man lure databasen til å gi tilgang uten passord. </p>
          <p><code>Brukernavn: admin'--</code> (Ignorerer passordsjekken)</p>
          <p><code>Brukernavn: ' OR 1=1--</code> (Logger ofte inn som første bruker i tabellen)</p>
          <p><code>Brukernavn: ' OR 'a'='a'--</code> (En annen variant som alltid er sann)</p>
          <p><code>Brukernavn: ' OR 1=1#</code> (MySQL bruker # som kommentartegn)</p>
          <p><code>Brukernavn: ' OR '1'='1'--</code> (En variant som også er sann)</p>
          <p><code>Brukernavn: ' OR '1'='1'#</code> (MySQL variant)</p> 
          <h3>Hente ut data (UNION-basert)</h3>
          <p><code>' UNION SELECT @@version, NULL, NULL--</code> (Henter databaseversjon på MS-SQL/MySQL)</p>
          <p><code>' UNION SELECT table_name, column_name, NULL FROM information_schema.columns--</code> (Kartlegger databasestrukturen)</p>
          <p><code>' UNION SELECT username, password, NULL FROM users--</code>  (Henter brukernavn og passord fra users-tabellen)</p>
        </div>
        <div class="card">
          <h3>Blind SQL-injeksjon (Inference/Time-delay)</h3>
          <p>Når applikasjonen ikke viser feilmeldinger, kan man bruke tidsforsinkelser for å bekrefte sårbarheter.<br>
          <p><code>'; waitfor delay '0:30:0'--</code> (Tvinger en MS-SQL database til å vente i 30 sekunder) [8].</p>
          <p><code>' OR IF(1=1, SLEEP(5), 0)--</code> (MySQL-variant som forsinker svaret i 5 sekunder hvis betingelsen er sann)</p>
          <p><code>' OR IF(1=0, SLEEP(5), 0)--</code> (MySQL-variant som ikke forsinker svaret)</p>
          <p><code>' OR 1=1; WAITFOR DELAY '0:0:5'--</code> (MS-SQL-variant som forsinker svaret i 5 sekunder)</p>
          <p><code>' OR 1=0; WAITFOR DELAY '0:0:5'--</code> (MS-SQL-variant som ikke forsinker svaret)</p>  
        </div>
        <div class="card">
          <h3>Systemtilgang (OS Commands)</h3>
            <p>  I visse konfigurasjoner kan man kjøre kommandoer direkte på serverens operativsystem.</p>
            <p><code>'; exec xp_cmdshell 'net user test test123 /add'--</code> (Legger til en ny bruker på serveren via MS-SQL).</p>
            <p><code>'; exec xp_cmdshell 'net localgroup administrators test /add'--</code> (Legger den nye brukeren til administratorgruppen) [8].</p>
            <p><code>'; exec xp_cmdshell 'net user test /delete'--</code> (Sletter den nye brukeren)</p> 
            <p><code>'; exec master..xp_cmdshell 'dir'--</code> (Lister filer på serveren via MS-SQL)</p>
        </div>
      </div>
  </section>

  <h4 style="color: #27ae60;">Sikringstiltak:</h4>
  <p>For å eliminere SQL-injeksjoner bør man alltid bruke <strong>parameteriserte spørringer</strong> (prepared statements) [10]. Dette skiller spørringens struktur fra dataene, slik at brukerinput aldri kan tolkes som kode [11]. I tillegg bør databasekontoen ha <strong>lavest mulige privilegier</strong> for å begrense skadeomfanget ved et angrep [12].</p>
    <section class="security-measures">
        <h2>Slik sikrer du nettsidene dine</h2>
        <p>Følg den trefoldige tilnærmingen:</p>

        <div class="step">
            <h3>1. Validering av input</h3>
            <ul>
                <li>Bruk <strong>whitelist</strong> for tillatte tegn.</li>
                <li>Begrens lengden på inputfelt.</li>
                <li>Bruk regulære uttrykk (Regex) for spesifikke felt.</li>
            </ul>
            <details>
                <summary>Se eksempler på Regex</summary>
                <code>E-post: ^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$</code><br>
                <code>URL: ^(https?|ftp)://[^\s/$.?#].[^\s]*$</code>
            </details>
        </div>

        <div class="step highlight">
            <h3>2. Koding av output (Viktigst!)</h3>
            <p>Konverter spesialtegn til HTML-entiteter før de skrives til skjerm:</p>
            <table class="encoding-table">
                <tr><th>Tegn</th><th>HTML-kode</th></tr>
                <tr><td>&lt;</td><td><code>&amp;lt;</code></td></tr>
                <tr><td>&gt;</td><td><code>&amp;gt;</code></td></tr>
                <tr><td>&amp;</td><td><code>&amp;amp;</code></td></tr>
            </table>
        </div>

        <div class="step">
            <h3>3. Eliminer farlige innsettingspunkter</h3>
            <p>Bruk <code>textContent</code> i stedet for <code>innerHTML</code> når du skriver til DOM-en med JavaScript.</p>
        </div>
    </section>
</div>

<div id="XPath" class="tabcontent">
  <h3>Blind XPath injections</h3>
  <p>XPath er et spørringsspråk for å finne data i XML-dokumenter. XPath-injeksjoner skjer når en angriper kan manipulere XPath-spørringer som brukes av applikasjonen.</p>
  <p>Dette er en underkategori til Command injections, der XPath-injeksjoner har ID 91, og er "child" til 74.</p>
 </div>

<div id="XSS" class="tabcontent">
    <header class="content-header">
        <h1>Cross-Site Scripting (XSS)</h1>
        <p class="lead">CWE-79: En av de vanligste sårbarhetene i moderne webapplikasjoner.</p>
    </header>

    <section class="intro">
        <p>XSS oppstår når en applikasjon tar brukerstyrt data og sender dem til en nettleser uten tilstrekkelig validering eller koding. Dette gjør at en angriper kan kjøre vilkårlig <strong>JavaScript</strong> i offerets nettleser.</p>
        <p>Dette er en underkategori av <em>Command Injections</em> (CWE-74).</p>
        
        <div class="image-container">
            <img id="myImg" src="Images/CWE79.png" alt="Illustrasjon av XSS angrep" style="width:100%; max-width:400px; border-radius: 8px; cursor: pointer;">
            <!-- The Modal -->
              <div id="myModal" class="modal">
              <span class="close">&times;</span>
              <img class="modal-content" id="img01">
               <div id="caption"></div>
              </div>
          </div>
    </section>

    <section class="variants">
        <h2>Varianter av XSS</h2>
        <div class="card-grid">
            <div class="card">
                <h3>Reflektert XSS (First-order)</h3>
                <p>Scriptet blir "reflektert" direkte tilbake i svaret fra serveren, ofte via en URL-parameter eller feilmelding.</p>
            </div>
            <div class="card">
                <h3>Lagret XSS (Second-order)</h3>
                <p>Data lagres permanent på serveren (f.eks. i en database). Dette er den farligste typen da den rammer alle som besøker siden.</p>
            </div>
            <div class="card">
                <h3>DOM-basert XSS</h3>
                <p>Sårbarheten ligger i klientens JavaScript-kode som behandler data fra DOM-en (f.eks. URL-hash) på en usikker måte.</p>
            </div>
        </div>
    </section>

</div>
</main>

<script src="Tabs.js"></script>


  <footer>
  <div class="footer">
       <a href="index.html">Hjem</a>
  </div>
</footer>

</body>
</html>